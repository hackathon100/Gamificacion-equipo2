import Excel from 'exceljs';
import moment from 'moment';
import * as fs from 'file-saver';
import _ from 'lodash';
import { getUserInfo } from 'util/localStorage';

const generateExcelFile = (headers, columns, rows, filename, sheetname) => {
  const workbook = new Excel.Workbook();
  const worksheet = workbook.addWorksheet(sheetname || 'Data', {
    properties: { defaultRowHeight: 30 },
  });

  // Set columns and headers
  worksheet.getRow(4).values = headers;
  worksheet.columns = columns;

  // Fill with data
  _.forEach(rows, (row) => worksheet.addRow(row));

  worksheet.views = [{}];

  const base64Image =
    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhIAAAE7CAYAAACIdmjcAAAgAElEQVR4Ae2dd3gc1b2/f39wY2NbzbKBAAEuoSaQACGFm0sJhB5CSG4KSSCFHiAJkAQwxca9gnvvtmzLluWiasmyiiVL7lXuVbLlbku2evv8nqPdY43WM1tmZ2dnZz7zPOeZ2SnnfM97zqxenZmd+X/gRAIkQAIkQAIkQAI6Cfw/ncfxMBIgARIgARIgARIARYKdgARIgARIgARIQDcBioRudDyQBEiABEiABEiAIsE+QAIkQAIkQAIkoJsARUI3Oh5IAiRAAiRAAiRAkWAfIAGdBI5W12Hp4QoM27YPr6/egp9mrMHdybn474XZ6J6QgbiEDFyzYAVuWZyD76euxi9z1+M/G3Ziyt4jKDx1DvXNLTpL5mGSQH1LC4oqqzD12HF8tP8gfr29FD9avwm3F6/DdYXF6FFQhJ4FRbhlzVrcs3YDnty8DW/u3osRR8qx9NRpHK2vl1lxTgIkoJMARUInOB7mPALiD3/qkeP4Z9E23J+ci7iZaYib5U6z0xA3Ox1xc9xpbnqbSAiZaEvzMhA3P7M9LcjENYuy8XzuegzfeQD7LlQ7D6jOGu+rrcVXZeV4YduOS7IghEFv+sH6jXh/736knTkLISacSIAEAiNAkQiMF/d2IIFNpyvxj8KtuH5OBmKnpyJ2hivFzUwNWibiFqxAXKIrPZmzFlP2leFCY5MDKXuvclVTM6Ycq8BTm7fpFgZ/ROOmohK8t3c/Nl+86D0gbiUBErhEgCJxCQUXSKAjgcKKM/hlRjFip6Ygdpo7TU8JqUx0X7gCNy1ZhQE79uNMfWPHgBz46UxjIwYePoKb15SEVCDUJENcJhGXTTiRAAl4J0CR8M6HWx1IYOvpSjybUoTYycsRO2U5YqeKZK5MdF+YheuX5KD/jn2obmp2XCtUNzdjwKEjuKHIfIHwlIrntm7Htou89OS4TsgK+02AIuE3Ku5odwJVDY14v2AruguBmLTMJRJhlonui7Lw7dR8pB87ZXf8l+qXfuYs7i5Zb/oIhKdAKD9fVVCEf+87AHGJhRMJkEBHAhSJjjz4yaEECo+dxl1zViB24jJXEiJhIZkQQvHmuu22vn/iQnMz/rZ7L3rkF7lSEDdQKiXAyGXxyw9e7nDolwSrrUmAIqGJhhucQKAVwIiNexA/YRliJyx1JQvLxP2ZhSittN+NgDura/CDtRvRI7+wXSSEUFhQJq5evabtVyOi73AiARIA37XBTuBcAg3NLXg1az1ixi1BzPgliB3vFgkhFBaWiW8szUFGhX0udWSdOYcbVxejR16hK0WATAjBeWP3HjS0Uiec+w3CmksCHJGQJDh3FIHqxia8sKwQMWOXuFKEyUTPxdmYe+hoxLfZ3IoTuDqvqF0iIkwmxC87xI2hnEjAyQQoEk5ufYfWvbapGY8vzEPMmGRXilCZiE/KwowD5RHbirOOHUfP3NXokVvoSlIi5DxCRiae3rINtXyQVcT2QwYePAGKRPAMmUMEERCXM36evBoxo5IRM9otEkIoIlgmFh6piKAWcIW66MQp9Fy1Gj1EsoFM/GrbDl7miLheyICNIkCRMIok87E8AXE1+7XMdYgZuRgxo0Syh0xck7wSBafOWp6/DHD1uUpcK0YdpEjYRCbEOzx4x4RsZc6dRIAi4aTWdnhdR23Yg5ivklwiYTOZuC0lD8frrP8CquP1Dbh9dQl65LhHI2wmE2PKI/++FYd/TbD6OghQJHRA4yGRR2BtxRn0GJnsEgmbysTP8taj2cK/IhCxPbdxK+JzChAvRMKGMvH11WuwrupC5J0gjJgEgiBAkQgCHg+NDAJV9Y349uQ0xIxIQsyXSbaWiUGl+y3bKIMPHEb8ygJXsrFMiIdW8QmYlu2GDCwEBCgSIYDKLK1F4O9ZGxEzfBFiRohkb5n4+uKVlnwl+b6aWnw9p7BdJIRQ2FgmxGvJOZGAUwhQJJzS0g6t58bjZxEzbCGihUg4RCZ+kb/Bcq39y43bEJ9d4EpyVMLGMtGzoAgbL9jvCaSW61gMyBIEKBKWaAYGESoCjyfkIFqIhMNkIuXoyVAhDTjflJOnEZ+Vj/hskZwjE+L5EpxIwAkEKBJOaGWH1nHFgQpED1mI6KFukXCQTDyUVWyJnyKKn0M+VLzBJRIOlInss+ccevax2k4iQJFwUms7rK6PzV6J6CGJjpWJTAu8j2PFqbOIX5HfLhIOk4mnNnNUwmFfO46sLkXCkc1u/0qvP3YG0YMTXcmhMvFkztqwN/TTJZtcIuFgmVh/gT8HDXtHZAAhJUCRCCleZh4uAn9LXYvoQQscLxM7wvjK8X3VNYjPzHMlIRIOlYl39+wL12nAcknAFAIUCVMwsxAzCdQ2NuPrw5MQPXCB42Xi0y27zUTfoawBew+2i4QQCofKxA1FJXypV4eewQ92I0CRsFuLsj5YtqsM0QMWuETC4TJxV0p+WG66FDdZ3pNXgvgM94iEw0cmlp8+wzOTBGxLgCJh26Z1bsXeTV2H6AHzKRMLViAucQW2nKsyvTNsrbqA+Ixcl0hQJvBPPqDK9D7IAs0jQJEwjzVLMonAd8amILq/EAnKRNyCFfhq10GTyLcXM+rAEcSnC5GgTPQoKMJ96za2w+ESCdiMAEXCZg3q9OocOV+N6H7zEN1vPmVifibiFmTixYJNpneLF9dvc4kEZQJCJEQqi4C3s5reUVigLQhQJGzRjKyEJLBo+2FE9xUiQZmIEyIxPxO3LV0l8Zg2vz27CPFpuZQJt0QIkVh86rRp/FkQCZhJgCJhJm2WFXICvVduQZQQCcpEm0RImThp4n/DJ+sbEJ+2yiUSlIlLIxL9Dh0Oef9nASQQDgIUiXBQZ5khI/CHxAJEfTGPMpGQgbh5GZdkoviUeY9qLj5bifhUIRKUCXlZQ8z/sjN8P8UN2QnHjEkAAEWC3cBWBB6clIGoPgmUCSESCplIPHTMtHZeePSESyQoE5dGI4RIPLZpq2ltwIJIwEwCFAkzabOskBO4Y8QSl0hQJlwi4ZaJcbsPhZy9LGD8gTLEp6yiTCjujxAi8d211nu9u2wzzkkgGAIUiWDo8VjLEbhuUCKieidQJuamt4tEQgb6b91rWlv133UA3YVIUCY6jEjcvKbEtDZgQSRgJgGKhJm0WVbICUT3nouotkSZiFPIxBeb94ScvSyg78796L48hzLhMSLRs6BIIuKcBGxFgCJhq+ZkZWLFaMTnlIm4OeloS26Z6L3ZvBv9epfuc4kEZaLDiIS4vMGJBOxIgCJhx1Z1cJ2uH7AQUZ/NpUzMdouEEIq56Riy3bw3UA7dfbBdJCgTl2TiG4XFDj4zWXU7E6BI2Ll1HVi3O4clu0SCMoE4hUyM22neY7LH7T+C7styKBMelzZuL17nwDOSVXYCAYqEE1rZQXX8wegURH06hzIxKw1xs0VyjUzM2ldmWi+YdfioSyQoE5dGI8RljQc2mP+octManQU5mgBFwtHNb7/K/2rWKpdIUCYQp5CJVRXmPZ551cmz6L50JWXCY0Tidzt22u+EY41IgA+kYh+wG4EPU9cj6pM5lImZaS6RcMtEWXWtaU1dVlPnEgnKRIcRiU8OmHd5ybTGZkEkQJFgH7Abgalr9yCq12zKxMxUxLll4tqETLSa2NCirOuW51ImPEYkZlQcN7EVWBQJmEeAlzbMY82STCBQfPikSyQoE4hzy8SjaYUmkO9YxGN569B9yUrKhEIm1lZd6AiJn0jAJgQoEjZpSFbDRaCxuQVX955HmZiRitgZYlQiFb037DK9e/TZsc8lEpSJtssbNxSVoKHVzHEh05ucBTqYAEXCwY1v16q/MGMloj6eTZlwy8TKo6dMb+qVJ860iwRlAr/eXmp6G7BAEjCLAEXCLNIsxzQCI/N3IOrjWZSJ6am4alY6apqaTWMvC6ppbsbXl+ZQJtyXNsaUH5VoOCcB2xGgSNiuSVmhA2cuoNtHQiQoE7/LXh+2DvGnkq3onpxNmSgowsHaurC1AwsmgVAToEiEmjDzDwuBR8amUSampSDpQPj+E86oOOUSCYfLxBObt4blHGChJGAWAYqEWaRZjqkEZq7bi24fznK0TNw8dwXqm1tM5a4srKGlBbem5DleJmYfP6HEwmUSsB0BioTtmpQVEgRqG5txY98FjpaJfhvMe+OnVq/rt2M/ui/OdqxM3Fa8DrUt4ZM5rXbhehIwkgBFwkiazMtSBPpnbXaJhANHJq6ZkYYTNeG/Ln+irh7XipsuHSoTgw+b944TS518DMZRBCgSjmpuZ1W2srYB1/ee50iZ6FW8wzKN/cnWPS6RcJhM3LJmLSqbmizTDgyEBEJFgCIRKrLM1xIERuXvQLf/zHSUTNw8KwNn6xoswV8EcbahEbem5DpOJsaVH7NMGzAQEgglAYpEKOky77ATaGhuwb3DljhKJmbvOhJ27p4BzDl0FN2TshwjEz9av4lPsvTsBPxsWwIUCds2LSsmCaw5dBJRH850hEw8vqTA1Bd0Sca+5uLh0E/lrnOETPTML0JxZZUvJNxOArYhQJGwTVOyIt4I9E7f6BIJG1/m+ObMdJyrb/SGIazbDl6swY3LVtleJvodPBxWziycBMwmQJEwmzjLCwuB5pZWPDE+w7Yy8d25WThXb537IrQaeUn5CZdI2PQyx7Obt6GZL+fSan6utykBioRNG5bVupzAscoa3NRnge1k4uWMtahrNv99GpcT9m/NR5t321Imbi9ai4oIkDn/Wol7kYD/BCgS/rPinjYgsL3iHK79bJ5tZKJvcakl74nw1lVaWlvx+8LNtpKJm1cXo7S62lu1uY0EbEuAImHbpmXFtAjk7atA949mR7RMxI5KxrjN+7SqaPn1Ta2teGaV++bLCL/McW1+IQrOVVqeOQMkgVARoEiEiizztTSBzJ3l6NlrTsTKxLhNkSsRsmOId3E8I3/JEaEycX1eEbLPnJNV4pwEHEmAIuHIZmelBYHCAydw/eeRd5mjT6F1nloZbE9qbGmJ2MsctxQUo+g8RyKC7QM8PvIJUCQivw1ZgyAI7DlZiXuHuh9YFQE/DX0ppTji7onw1TzinolPt+5BvBiViJCRiR8Vb8DemlpfVeN2EnAEAYqEI5qZlfRGoKaxCQ98udzylzm+OzUD4j94u04rKk7jluW5lpeJd0r3oDaMr2e3a/uzXpFLgCIRuW3HyA0kcLyqFrHiLaFiVMKCIxM9v1qMQ5X2/1VAeU0dfr16oyVl4rb8Yiw6ftLAXsesSMAeBCgS9mhH1sIAAq/PL0C3f7tFwmIyMWhNqQE1jJwslh89ibvTCizxbo6e2fn4YNdenG/kmzwjpwcxUjMJUCTMpM2yLE1gzcET6PavGZaTiXumpEO8fMxpU3VTM0bsOoibl+e5hCI5G91FWrKyPS1die4iLctxpeU56C5TyirEi5TqTmmrEJ+W60rpuYgXKUOkPFfKzEO8TCvyEb8iHy9u3o5tFy46DT3rSwIBEaBIBISLO9uZgHiy8d2DkiwnE1kHj9sZu8+6XWxqwoR9R/DDrDUukQixTFyXXYC/bduF7RQIn23DHUhAEKBIsB+QgILA4KwtLpGwyMjEkwk5iui4uOFsJf6zZTduS8tvH5UQIxRBjkxcnZmH59duwfQjx3COlzDY0UggIAIUiYBwcWe7EzhwugrdPphhGZnIOlBhd+S66id+MrrpXBXG7juCl9duw70rihAfgEzctKIAT6/ZhE927kPKiVOoauL9D7oaggeRAEck2AdI4HIC9wxebAmZeGjGisuD4xpNAjXNzdh1oRr5p84iteIUEsuPY+bhY5h95BiWHjuJlafOYt25Spzgi7U0GXIDCeghwBEJPdR4jK0JvL+42CUSYR6ZmL3loK05s3IkQAL2IECRsEc7shYGEsgsLUe396eHVSauGZoE8aAsTiRAAiRgdQIUCau3EOMznUBtYzOihEiEUSb+lFxker1ZIAmQAAnoIUCR0EONx9iewN39F6Hbe+GTiYU7DtueMStIAiRgDwIUCXu0I2thMIH/m5LlEokwyERMv3k4XVNvcI2YHQmQAAmEhgBFIjRcmWuEE+iXvhHd/jktLDJx//jUCKfH8EmABJxEgCLhpNZmXf0msGTLIXT7x7SwyMRrS9f4HSd3JAESIIFwE6BIhLsFWL4lCRQdOOESiTDIxOg1uyzJhEGRAAmQgBoBioQaFa5zPIHdJ86j69+nhkUmUneXO54/AZAACUQOAYpE5LQVIzWRQEVlTZtIhEMmthw/Z2JNWRQJkAAJBEeAIhEcPx5tUwLna+rR9d2pYZGJI+erbUqV1SIBErAjAYqEHVuVdQqaQE1DE7q+MzUsMnGWP/0Muv2YAQmQgHkEKBLmsWZJEUSguaUVXd+ZEhaZaGhuiSBSDJUESMDpBCgSTu8BrL8qgTaReFuIhPkyQZFQbRKuJAESsCgBioRFG4ZhhZdA26UNIRJhkAle2ghv27N0EiCBwAhQJALjxb0dQuB8TQO6/m2ySyRMlokj5y86hDKrSQIkYAcCFAk7tCLrYDiBY+er0fWtyWGRiS0VZw2vDzMkARIggVARoEiEiizzjWgC28rPuEQiDDKRurMsotkxeBIgAWcRoEg4q71ZWz8JpGw5hK5vTg6LTIxeXepnlNyNBEiABMJPgCIR/jZgBBYk8MXS9ej65qSwyMTriwotSIQhkQAJkIA6AYqEOheudTiBH3yxCF3fECJhvkx878tlDqfP6pMACUQSAYpEJLUWYzWFQFNzC7q+PhFdX58UFpmI7jULZ6rrTakrCyEBEiCBYAlQJIIlyONtR+DQqSp0fU2IRPhkYuGWg7bjygqRAAnYkwBFwp7tyloFQWB24S50ESIRRpl4eV5+EDXgoSRAAiRgHgGKhHmsWVKEEPhxv0Xo8uqEsMrEVZ8lQDxdk5P/BOqam7G78iLyjp9BStkJJB46hpn7yjB7fzmWlh1HTsVprDtzHidqednIf6rckwR8E6BI+GbEPRxEoLq+CV2FRLwyIewyMWf9PgeRD6yqrQC2nq3C2NKDeDlvI+5NzkP3OemIE2luOuISMtrTvAzEzc9sTwsyccPiHDyVsxa9Nu9G2tGTqGqktAXWAtybBNoJUCTaWXCJBLBw7T50+atbJMIsEw+NSWWLeBDYePo8/l2yA3ckZiNuZhriZrnT7DTEzXaLhJ8yEbdgBeISXemqRVl4Pm8DZhwox/mGRo9S+ZEESMAbAYqENzrc5jgCD/VNQpe/jreMTGTvOea4NvCs8MXGJozfcRDfX5yL2OmpiJ3hSnEzUw2Vie4LV6D7wixcm7wSb63bjm3nL3iGws8kQAIqBCgSKlC4ypkE9h4/jy5/Ho8ufxEiYQ2ZeHx8ujMbA0B1YxNGbNmLm+ZkInZaiitNTzFFJrovyoJILxZtplA4tgey4v4SoEj4S4r72Z7Anydkocufx1lOJrJ2H7U9e88KLjtYgbvmZSN2ynLEThXJLRJCKEyWiR6Ls/HBpp2o5H0Uns3EzyTQRoAiwY5AAgAOnqxENzEa8SchEtaSie8OTUZdU7Mj2ul4TR1+lV6M2EnLEDt5uStZQCa6J2XhtpQ8LCw77oh2YCVJIBACFIlAaHFfWxJobG7BN/8+A11eHucSCQvKxMDsLbZkr6zU/spq3DwzA7ETl7lEwoIyIYTi7Q2lqG12htgp24fLJKBFgCKhRYbrHUGgvrEZ33pvNrq8NNaVLCoT3T+ajc1Hz9i2TSqq63CNGIGYsNQlEhaXiQey12DfhRrbtgcrRgKBEKBIBEKL+9qKQHNLKx7otQBd/jgGXf7oFgkhFBaVibsGLUZVXYOt2kBUpqapGffMzULs+KUukYgQmbglJQ8bzlbarj1YIRIIlABFIlBi3N82BP4ydgWu/P0YdPmDEInIkIk/zs5Fq3gak00mUZWXM9YiZtwSxIxfEnEycf2yVVh5wr4jRTbpZqxGiAlQJEIMmNlbk0DvxDW48sXRbSIRaTLxefpGa0LVEVWfNTsQM3aJK0WoTFyzJAcFp87qqD0PIQF7EKBI2KMdWYsACEzK2oorfzfaJRIRKhNjC0oDqLE1dx2/eR9ixiS7UoTLxE3Lc1FaddGaoBkVCYSYAEUixICZvbUITM3eji6/G4Ur21LkykTUv2cgkmVCSETsqGTEjHaLhBCKCJeJ21LzUcEXglnrhGc0phCgSJiCmYVYgcD0lTtw5W9GudJvI18muv1rBr7I3BRx90z0W1OKmJGLETNKJHvJxLP569Fsp5tYrHDiMgbLE6BIWL6JGKARBBJX78aVvx7pSjaTCXED5oU6679oqqW1Fa9nrkPMV0kukbCpTPTdwbe2GnHOMo/IIUCRiJy2YqQ6CWw8cBJdhET8n1skxLLNZOI7gxdjY7l1fz1Q09iERxNWIebLJJdI2Fgm4pOyUHzmvM7eysNIIPIIUCQir80YcQAExFMr73l3Fq781VcukbCxTMR/PAfDcrZBPB/DKpMY5Z9fehhXfbUYMSMWIWZEkiNk4ocritBooXawSn9gHPYkQJGwZ7uyVm4CI5dtwJW//MqVHCAT3f49E/ePWIqcveF//Xj+kZP4wfRMRA9biOjhixAjkoNkYuzewzwPScARBCgSjmhmZ1aysqYe17w0Hle+8KXjZKLbf2bi2UkrUHjwhOmNX1h2Cs8tyEP0kIWIHrrQJRIOlImbl+fyjaGm9z4WGA4CFIlwUGeZphDoN38NOv/iS3QWIuFQmRBC8fCYNMxZvw/VDU0h4y7ynrP1IB6ZmYXowYmuNCTR8TIxqHR/yJgzYxKwCgGKhFVagnEYSqC2oQnXvTTeJRKUCXT7cBau+iwBf5qXj8TNB3C6ui5o3qdr6pG4/TD+vKQI1wxNQvTABa40aAFlYmEWui/Kwq3Lc1HX3BI0a2ZAAlYmQJGwcuswNt0EZq/cgc7Pj3AlIRKUiTaZEELR7aNZiO41C/d/tQxvJBVhVEEp0neVY/vxczh07iLO1zZA3KQqklgW67afOI/0PUcxes0uvLGsGN8fn4qYfvMQ3W8+ovvPR/QAkdwiIYSCMoHubplIOBT++1V0n0g8kAT8IECR8AMSd4k8Ak/0WojOP3eLhBAKygTEZY42kXDLRNTHsxD18WxE9XKnT+Yg6lN3+mwuokT6fC6ieouUgKg+7vTFPET1nYdokSgTiJuf6UoLMhG3YAXiEl2p+8IVbTLxXN76yDuBGDEJBECAIhEALO4aGQSOnKxCFyERz42gTPxrBsQTMMWvOdpEgjKB2KkpiJ3mTtNTEDs9FbEzXCluZiriZqYhbpY7zU5D3Ox0xM1xp7npiEvIaE/zMtpFQgiFikz0WJSNsprgLyVFxtnHKJ1IgCLhxFa3eZ2/XLwOnX82HJ2fE4ky0SYSlAnETl6O2CnLETtVJHNlYvTuQzY/61g9JxOgSDi59W1a9+d7L3aJBGUC3T6Y4UocmXCJRJhk4tcF9nn1u02/NlitIAhQJIKAx0OtR6CxqQXxvxqJzs8Op0y8Nx3d3p9OmZi4DLGT3EmIRBhk4rrFK/mkS+t9XTAigwhQJAwCyWysQaB45zF0fmYYOj8rEmWiG2UCsUIkLCATJaf5/g1rfEswCqMJUCSMJsr8wkpgctpml0hQJtDtn9PQJhKUCUvIxPT9ZWE9N1g4CYSKAEUiVGSZb1gI/GtSDjo/PZQy8Y9p6CYSZQKxE5a6UphHJnpt2h2Wc4KFkkCoCVAkQk2Y+ZtK4BefJblEgjLhEgnKBGLHu0VCCEUYZeI3+bzh0tQvAxZmGgGKhGmoWZAZBO57Yzo6PzWUMvH3qej696mUiXFLEDN+iSVk4odpq804BVgGCZhOgCJhOnIWGEoCt7w0wSUSlIk2kaBMLEGMRWTi1uRVoez6zJsEwkaAIhE29Cw4FASu/uVIdHpyCGXinano+q5rVIIyYQ2ZuHZhdii6PPMkgbAToEiEvQkYgJEEujw1FJ2eGEKZeGcKulImEDMmGTFjl7iSBUYmjOzrzIsErEKAImGVlmAchhDoLCRCJo5MUCaESFhEJronZBjSx5kJCViNAEXCai3CeIIicNUvvkKnxykTXd+egrbEkQmXSFhAJm7kpY2gzm0ebF0CFAnrtg0j00Hg5hfHodPjgykTf5vsEgkhFJQJS8jEXUtydfRoHkIC1idAkbB+GzHCAAg88NZMdPqpEAnKRFfKBGJGLUbMqGTEjHZf4gjjyMRP0osC6MnclQQihwBFInLaipH6QeC3vZNdIkGZQNe3JoMyIUTCGjLxcv4mP3owdyGByCNAkYi8NmPEXgh8OiUXnR4bTJl4c7JLJCgTiBlpDZn4go/I9nLmclMkE6BIRHLrMfbLCCzIKUWnxwZRJt6chK6UCcR8leQSCQvIRNKhisv6K1eQgB0IUCTs0IqswyUCh49XotOjQiQoE10pEy6RsIhMHLlYe6mfcoEE7ESAImGn1mRd2gjc8YcJlInXJ6HrG2JUgiMTbaMSYZaJexbzFxv8erIvAYqEfdvWsTV7c3i6SyQ4MkGZGJGEmC+Twj4y8W7RNseej6y4/QlQJOzfxo6r4eK8Xej0k0GUidcnoitHJhBjAZlYdpj3Rzjui8hBFaZIOKixnVLVmvpGdH96OGXiNSESlImYEYvCKhPXzslAbVOzU04/1tOBBCgSDmx0J1T5tSGpLpHgyARlYrgQifDJxNurtzrhlGMdHUyAIuHgxrdz1deWHkWnRwZSJsSoBEcmEBNGmVh/6pydTzXWjQRAkWAnsC2BB/82izLx6gR0oUwgWohEGGTipymFtj2/WDESkAQoEpIE57YjkFG83yUSHJm4TCa6vTkJ9/VJxGszczEyeytSth7G9qNnUVFZg+r6xkt9QSyLdduPnUXqtiMYmbMNryfk43uDkxH1/nR0E+mDGa70rxnoJtK/Z6Lbf9zpw1noJtJHsxD1sUizEdXLnadTYBUAACAASURBVD6Zg6hP3emzuYgS6fO5iOotUgKi+rjTF/MQ1XceokXqJ9J8RPefj+gBIi1A9EB3GrQA0YMTXWlIIqKHLET00IWIHuZOYZCJzCMnLrHkAgnYlQBFwq4ty3q1EXj47dmUiVcmoMurE9Dj7al4aVI2FpTsxekLdUH3kNMX67Bgw368PDsXV300hzIxaRliRZq8vC09sZyjEUF3MmYQEQQoEhHRTAxSL4F1O4+hsxiRkEncfOmwGzB/3DcJswt34aJipEEvT63jxMjFnHV78fDIFNeohMNHJuImL8f6k7w3Qqu/cL29CFAk7NWerI0KgbeGpaPTw86TiaeGLEP+rqMqREK7qvDACTwzIcPRlzn+kb8ltJCZOwlYiABFwkKNwVBCQ6Cyuh63/GasY2Tivo/nIWvbkdDADCDXrN1Hcf+wJY67Z+KuuVmobGi/zyQAZNyVBCKSAEUiIpuNQQdKoHh7ObqJ14vbeGQi7i8TMHjZejQ0tQSKJ2T7Nza3YOjKrYj/eI4jbsDsOWk5So6fDRlPZkwCViRAkbBiqzCmkBAYPq/YJRI2lIlvvz8bGw+eDAk3IzLdVH4Gdw1abHuZGLl5rxG4mAcJRBQBikRENReDDYZAayvw537LbCcTfxiVgQu1DcGgMeXYusZm/CUh37Yy8Vr2BrSaQpKFkIC1CFAkrNUejCbEBBoam/HkPxNsIxO9E4shBCmSpvTSMsR+NMslFDZ5zsRzSwvR0GKdS0qR1B8Ya+QToEhEfhuyBgESqK5rxENvzYxomejy4miMTtscYM2ts/uF+kY8MibVFjLx+KI8vpTLOl2LkYSBAEUiDNBZZPgJXKxtwLMfzItYmRgTwRKhbP2+KzYh6sOZrqdfRuATMF9YWojqxiZllbhMAo4jQJFwXJOzwpKAuMzxp75LI04m+i0sllWwxTyttAw9P5kTcTLxauY6NDTzcoYtOiErERQBikRQ+HhwpBMQ9xcMnlOELuJplxHwa473puVGOnLV+HccP4fvDk2OCJnoPnIxhq3dxRsrVVuSK51IgCLhxFZnnS8jULD5iOUfWvXhrPyIu7HyMtBeVlyoa8Sr8wssLRPfmpKGgrJTXmrBTSTgPAIUCee1OWusQUA8AfOdERm4UoxOWOjdHN98dQpS1x3QiNp+q1N2HMFtAxa5hMIibw2NG5GE97I3oiqE7yuxX0uyRk4hQJFwSkuznn4TEC/6esQCbw2Nf3EM+iQU4WKd8x63XN3QhC9WbMJVnyWE/RXkT8xbhXUVfFql3ycQd3QcAYqE45qcFfaXQMGWI3ha/LJDjE6Y+NbQq18ci95zi3C6qtbfUG273+nqOvTJ3IRr+8xH1MezEPXxbET1cqdP5iDqU3f6bC6iRPp8LqJ6i5SAqD7u9MU8RPWdh2iR+ok0H9H95yN6gEgLED3QnQYtQPTgRFcakoifL8jHal7GsG3fYsWMI0CRMI4lc7IpgQ27K/DmsDT0eHZESF9B/uAH8zA+dTMqa+ptSlJ/tarqGjBxzS78ZHxaSGXi2hFJeCd9HTbxfRn6G4tHOo4ARcJxTc4K6yVQW9+EJQW78bcRGfjWSxPR6dFB6PSYSIPR6afu9PhgdHp8CDo94U5PDkHnp4a60tND0VmkZ4a1pdgXvsKTHydi0IJi7C7n0Lm/7bLnVCWGrNqGZ6dmoefnCYgKcmTinvEp+Hv6eizfXc4HS/nbCNyPBBQEKBIKGFwkgUAIlJ+qQlLeLgycW4Q/D1yOB9+djTtemojrfz0acT/7sk0mrvnlKHzzj+Nxz2vT8LNeC/He+JWYkLIJ+dvKUNfABxkFwltt37qmZqw+eAKTSnbjg5R1eH7mStw/OgV3Dk/GNwYtbLvMcVX/RNw8bDHuHrUMj07LwitL1mBowQ4klx7B0aoatWy5jgRIIAACFIkAYHFXEiABEiABEiCBjgQoEh158BMJkAAJkAAJkEAABCgSAcDiriRAAiRAAiRAAh0JUCQ68uAnEiABEiABEiCBAAhQJAKAxV1JgARIgARIgAQ6EqBIdOTBTyRAAiRAAiRAAgEQoEgEAIu7kgAJkAAJkAAJdCRAkejIg59IgARIgARIgAQCIECRCAAWdyUBEiABEiABEuhIgCLRkQc/kQAJkAAJkAAJBECAIhEALO5KAiRAAiRAAiTQkQBFoiMPfiIBEiABEiABEgiAAEUiAFjclQRIgARIgARIoCMBikRHHvxEAiRAAiRAAiQQAAGKRACwuCsJkAAJkAAJkEBHAhSJjjz4iQRIgARIgARIIAACFIkAYHFXEiABEiABEiCBjgQoEh158BMJkAAJkAAJkEAABCgSAcDiriRAAiRAAiRAAh0JUCQ68uAnEiABEiABEiCBAAhQJAKAxV1JgARIgARIgAQ6EqBIdOTBTyRAAiRAAiRAAgEQoEgEAIu7kgAJkAAJkAAJdCRAkejIg59IgARIgARIgAQCIECRCAAWdyUBEiABEiABEuhIgCLRkQc/kQAJkAAJkAAJBECAIhEALO5KAiRAAiRAAiTQkQBFoiMPfiIBEiABEiABEgiAAEUiAFjclQRIgARIgARIoCMBikRHHvxEAiRAAiRAAiQQAAGKRACwuCsJkAAJkAAJkEBHAhSJjjz4iQRIgARIgARIIAACFIkAYHFXEiABEiABEiCBjgQoEh158BMJmEag98hs9Ly/b8DpugcG4NZHh11K9/5sFB741Tg8+adp+P0/5uOf/VIwbeE6bNlZgcamZtPqw4JIgAScSYAi4cx2Z60tQOD0uWrE3/cFrrj145ClHt/7An/9cBHWbyu3QI0ZAgmQgB0JGC4Sb366BKFO+WsPWrIt0nJ3+/yDcN9zow39L/Hmh4f4LLNwwyFL8srM3xPyvvJe/xRL1l0GNXhirs/2M0Q0bvsY//f2XBwsOyuLtvy8cGsZvvbjfvjaj/vja//rTg8OwNceGoBOIj08AFc9M8Ly9QgkwC6vTECXV0WaiK6vTUTX10WahK5vTELXNyeh61uTkbH9SCBZhnzf9zLWI3rAAkQPXIDoQSIlInpwIqKHJCJ66MK29FneVsPiKD1bhdhJyxA7ebkrTVmO2KkipSB2Wgpip6fghrmZhpVnREbltXWIT12F+LRcV0rPRbxIGSLlIT7TlUovVOsq7vXS3eiRuxo9cgtdKa8QPWTKL0SP/KK29MquPbry93WQ4SJhyJeej//QJiaU+KpXWLb7IxKCj/jjYdQUySIxZGJeyP+Iiv/4rTzV1jXipgcHh5zDFbd9jCtu64Xu932BRRnbrYzkUmwUCfuIRPcRi7D15PlLbRvMAkWiI73V5yrRY5WQCO8icUvRWpxqaOx4sEGfKBIGgRTZ+CsS3e76DHsPnTakZIqE98sCVhcJ0QlmJm0wTSSETFxxey98PjLbkP4XykwoEvYRiehhC/HgnGw0tbQG3WUoEu0Im1pb8eDajX6JRMLxk+0HGrxEkTAQqL8iIUYlfvL7yWhtDf6kokhEvki0tLTinmdHhVYm3CMSUiSETAydnG9g7zc+K4qEvUQievgijFq3O+iOQpFoRzi5/JhLInyMSLywdQeC/2vTXq7nEkXCk0gQnwMRCSETUxPXBVGa61CKROSLhGjJjPw9potEp299ijyL3m8kmFAk7CcSV49MxsHzF4P63qNIuPCdbGjANwuKfYrE9avX4GBtXVDMfR1MkfBFKIDtgYqEuKP+2MmqAEq4fFeKhD1EQrTsEy9PDZ1MqIxIiFGJmx4Zgpq60Fw3vby3BraGImE/kYgZvgjPL8oP6r9jioTrPHpn5552ifAyIjGqLPS/2KJIBPbd5nXvQEVCjEr8+u25XvP0tZEiYR+ROHW2Ghu3H/WZSjaXYWXRPizNLsWYWUX418A0/PKtObj+fwZqi4iGSFxxRy+MmFbgq5uFZTtFwp4iETNiEebu0P9LMooEsL7qAnrmrPYpEo9s2AxxH0WoJ4qEgYT1iISQiSVZO3RHQZGwj0jo7gSKAw8fPY8Jc4vxnWdGdpQKLyJx80+Goqm5RZGLNRYpEvYViZvGL8fJmnpdHc3pItHc2orH1m1CDx8icXV+EbZcCO4ykr8NFBaREDeW/eCFsbpTkkV/vqZXJG748SBUXtB3DcvuInHV/X119xPRxx79w2R/zwVb7SeeaPnKR0ntMuFFJMSoRG7JAcvVnyJhX5GI+TIJf0nT9zN+p4vE9PIKxOcU+BSJz/frH/UJ9MsgLCJx5JgxvycOtLKh3l+vSIhRCfEQLz2T3UXipfcX6MHCYwA0N7fgkRcnuWTCh0h8OMxaD/ARDUiRsLdIxHyVhIyDFQGfq04WibONjbg1v9inSHyvZANqms17PD5FIuBurH1AMCLxX7f1QsG6wJ/YSZHQbg9uAYo3HfFLJJ78y3TL4aJI2F8k7pyShosNTQH1PSeLxL9270P8ygKfIrHqnLn/rFMkAurC3ncORiTEqMSdj49AXX1gJxVFwnubcCvwzUeGQj7ZUvkcCfGrDXFZQ6QbHx5iOVQUCfuLhBiV+GDV5oD6nlNFYuuFi7gqZ7VPkXh7196AeBqxM0XCCIruPIIVCSETn32ZFVBEFImAcDlyZ/HLIF8iEX1PH8uxoUg4QyTiRiWjpOKM3/3PiSIhfnfx5PrNLonwMiJxe+FaiMsfZk8UCQOJGyESV975KbbtPu53VBQJv1E5dse3ey/1KRJX3PGJ5fhQJJwhEjEjF+OHc7JR7+cvh5woEvMrTrRLhBeRSDpxKiznMUXCQOxGiIQYlfjRL8e13SjnT2gUCX8oOXsfcSOvrxEJioQ1+ohd3/4p3rUhHpEtHkglniMhfrUhLmu0pZGLETNqMQaV7PSrEZwmEheamnFnfolPkfjNVv2PEfALvJedKBJe4AS6ySiREDIxakahX8VTJPzC5OidfvbKDJ8icfWPBliOEUcknDMiIUSi59gl2HX2gs9+6DSR6LVnP+KzC7yKxI35a1BWp++5HD6B+7EDRcIPSP7u4o9IfP2H/SHe/ilkwVuK/W5vHD56zmfRFAmfiBy9g7h5t/u9fXyKxPd+MdZynCgS9hGJOyam+ByREDLxxKI8tPh4EqOTRGLnxWpcLS5l+BCJiWXHwnr+UiQMxO+PSIiHcQ0cv8qrREjBeOavvn+SR5EwsAFtmNXCtG1+/fzzrx8lWa72FAn7iMTn+Vvx+LxVXi9tCJGIGZ2MSVu9PxzNSSLx/IatiM/O9yoST2zYAvG0y3BOFAkD6fsrEg2Nzbj76a/8kok5SzZ5jZAi4RWPozdWXazH7T8d7pdIzEjaYDlWFAn7iETvgm3YcaoSPb5crHmPhBSJ6yYtx9GLtZr90SkikXz8FOKzhERoi8TXcwtRerFak5VZG8IiEhMTSrAofZvudODIWbP4BFSOvyIhMi3aeBjiIVRy9EFrfs0P+uP0Oe2OYneRePh3k3T3E9HHxIutnDgJiejwNlEvT7bscvdnEC8Ms9pEkbCXSIj+1adgu0+RiBmTjN+mrtHsjk4QiermZtwlbrD0IRL9DxzW5GTmhrCIhNYfTX/XCxGx4hSISIj43/gk2adICCYvf5CoWV27i4S/fUJrv/j7vtBkZ9cN2YX72h5u1oGJF5H44wfWfAw5RcJ+IlHb2IzvTk1X/dWGHJEQIhEzNhmL9x5VPUWdIBJ99x50SYQXkfhh8QbUt1jjZXsUCdWuqm9loCJxrrIW1z0wwC+ZyMzfoxoURcL7TatOEAnx5s7Npccwcnph20+HOwiEvKlXQyQ6f/tT7Dvs/8OAVDthiFZSJOwnEqKrrDx0wi+RuGVaOs7VN1zWu+wuEgdqavH17NVeRaJHTgGKzldexiZcKygSBpIPVCRE0fNTtvglEt98ZAgu1lx+UlEknCESn3+Vhd/9fd6l9Nt3E/CT30/Gt5/80q9fAWk9R+KDQWkGngHGZkWRsKdIiF7yStray54j4TkiETN2Cd7K2XhZp7K7SPxm43bEr8j3KhL/DMNjsC9rCMUKioQCRrCLekRClCl+naH6X6T8b9I9f69/ymUhUiScIRLJK3b41Uc0+5HKiMR9z48J+N0ul3XAEK6gSNhXJE7W1OPG8cs7PJBKTSRixy1BbnnHpzXaWSSG7T/skggvIiHe/lnZFNg7mUJ4mrZlTZEwkLBekThYdhZRd3/u8w9Fpzs+wdotZR0ipkg4QyREoz/42wk++4i/InHLY8NQftw6Q6MdOrX7A0XCviIhmnjm9oM+RSJm3BLcMzcbtU3tr8S2s0i8vnWnT5EQL+7afOGi2ikTtnUUCQPR6xUJEcKQiXl+/ZEQz6FoVJxUFAnniMSaje5XgnuMVGnKg3I/xYjE/S+MtbxEiHOCImFvkWh7EVViLsS7NtpGI9zPkZA3W4pLG0IkYsYvxWdr2h//bGeR2Fx1Ad9fvc7npY1H1m1CU5ifHaH800mRUNIIcjkYkRBycO/PRvklEwPGrboUKUXCOSIhGr3tTZ5KQfB3+baP0fnOT/GvQWmWvpxxqWNTJND1NXuLhGjrXWer0HPMEp8i0WPiMmw57RpBs7NIlF6oRs6Zcz5FIj6nAGOPqP+qRXkOmbUcFpEQf/xufXSY7pSwLLD315sFMxiREDGK/zi/drvvZ0uIR2zvOXi6rVp2FwnxqPBg+sp9z402q/lNKUe0e+c7PvFLOOVIRfR3PsdrvRZj7yFXnzElUAMK4YiE/UVCdJN+a0p9ikTs+KV4aFEumlpaYXeREEz+tKXU682WQiRuyBPv16gz4EwLPouwiMSRY+eDj9yCOQQrEqJKba989uO/zEdenITW1lbYXSReet+azzgIZ/fzt4/8/LWZyFq9N2JGIDyZUiScIRJ1zc24d9YKl0yMTobapQ0hErETluKrzfscIRLldfX4Rk6hSya8PNnyt2F846fyfKVIKGkEuWyESJyvqsM3/megX/9xTppXQpEIss0i8fATpy8i7p4+PvvId58dCfE49kidKBLOEAnRP/PKTiLWyz0SUiSumZqK1EPHETtpGWInL3elKcsRO1WkFMROS0Hs9BTcMDfTUt2+vLYO8amrEJ+W60rpuYgXKUOkPMRnupK4tCGnkYfKfIpEj1WrkXyy469a5PFmzikSBtI2QiREOJdetORjZEI8bEkkOYStNS/ccMjAWhqXlT83mHJEQp1339Erfba76A/K+2nUc7LuWoqEc0RC9MLXV6xve2mXtxGJ2InL8J2EbEeIRENLC35UtN7ruzaESNxZWILzYf45KEXCwO9Ro0RChPTcqzP9+kOhJQ/K9RQJAxvZIllV1zbgej9Grrp+u/1+GouE7ncYFAlnicTp2nr89+RUr5c2hEi0JQeMSIgTJVfceOnl0oYQCZHe273P7/MqFDtSJAykaqRIHD56DjHf6W2ITFAkDGxkC2U1ef5av/qHvJ/GQqH7FQpFwlkiITrFnNLDFAmPs+Ov23Z6fY24EImeq1ajuLLK40jzPlIkDGRtpEiIsEZMLfDrD4Vy9EFtmSJhYCNbKCvxjo27nvLvdfRTFqy1UOT+hUKRcJ5IiGdLPJNc0PbSLuVzJOQ9Ek4bkRBnyrH6etywqgjxKwvaU04BeuS4RiPkqMT/rN0IcTkkHBNFwkDqRouE+EMhfr6oJgeBrKNIGNjIFstKvCbdn77Q4/4vcOxk+P5j0YONIuE8kRD9ZO+5i7hqwlJQJNrPmlGHytslQgiFikj0yF2NYYc6Pvm4PYfQLlEkDORrtEiI0NZtLYd4NLY/fyy09qFIGNjIFszq4d9N8t0/bvsYv3k3wYLRa4dEkXCmSIgeMXDtToqE4tRobG3Fj4o3tMuEhkhcm78G+2pqFUeas0iRMJBzKERChPdun2W+/1B4+YUHRcLARrZgViWby/Bft/l4kJn7EdnLVu60YA3UQ6JIOFck6ptbcP/c7EuPyHbypQ15dqw+d96nSPTILcTPN2+HuERk5kSRMJB2qESi6mI9bvzfQbplgiJhYCNbNKvfvJPgvX+4ReLGBwdD9KdImCgSzhUJ0T9XHz0N8fZP8a4NioTrjH11+y6XTGiMSAiREGnu8ROmnuIUCQNxh0okRIjBvEaaImFgI1s0q/2Hz+DKOz/VlgnFS7ve7rPMorXoGBZFwtkiIXrDWzkbKRKK06KivgE35BZp3iMhReLWwhKcbmxUHBnaxbCIhHgQkbiLXG/aue9kaKnozD2UIiFC+sUbs7T/UNj00sYDvxqnu5+I/jVr8UadrRl5h/2j73Lt/qEQia/d+QmKNh62fAX9EYmYx4di2Lzi9jS/GMNkWlCMYTIllmCYOw1PLMHwhSWYlGq9d/Z0eWUCurwq0kRHvLTLVyc8W9eAb87I4IiEAtS4I+U+RaJHXiHe2LlHcVRoF8MiElo3Bfq7fmJCSWip6Mw91CJRVlEJ8RIrfznJ/SJ5RELWQe9cPPnTKdOps9Xofq/Go7MVInHF7b1w97MjUd/QZGk0/ohEp4cHotMjA9HpJyINQqdH3emxwej0U3d6fDA6PTHElZ4cgs5PDkXnp4bi1pcnWq7+FInLm2T+7jKKhAKLuPHyxyUbLvv5p/jVhhyRECIh0qqz5rzXiiKhaKBgF0MtEiK+kdMLKRJeRl88hcNJIiH6x+CJuer9w0MkhEz0HZMTbJcP6fEUCV7aEB1M3Dj4/PKitpd2OfE5EmonmbjxsqfHcyTUROJ7JRtQa8KzJSgSaq2kc50ZItHc3ILv/2KM+h8LjT+wHJHQ2aAReFhtXSP++6HBl/cPFZHoevfn2LU//C/80cJMkaBIyL6xv7IaV4uXdDnsEdmy/mrzN3bsbns8tnwglZpIiFGJLw6G/l1LFAm1FtK5zgyREKFt3H40oGdLUCR0NmiEHjYreaNfIiFGJR76vet19FasKkWCIqHsl8M27KFIKICcaGjAfxesaZcJlUsbQiSuKSjCjur2t4oqsjBskSJhGErALJEQIb/XP+XyPxYckbiMidMubYi+0dLSiu/93OOJqCojEkIkrrijFybOs+Y9RxQJioTy61k8/vkHiasc9dIuZf3VlieUHfUpEj3yC/HEpq1obg3d0yUoEmqto3OdmSJxsaZBfQhbRSY4IqGzQSP4sJVF+zpKlReRiP9+Xxw9Yb3HZ1MkKBKep+CaijOIE5c3HPL2T8/6e35uam3Fg2s3umRCY0RCiESP/CJMOVrhebhhnykShqE0d0RChL3Mz/csUCQMbOQIyurpv0xvlwkvIiFGJX719lzL1YwiQZFQ65T/yN9CkVCAKT5f1fb2T617JKRI3FRYgmP1DYojjVukSBjH0tRLGzLs//vb3PY/FiqjEeJXDBQJSctZ8227j+Nr4vKF6Bc+ROKKOz5BclappQBRJCgSah3yXH0Dbp2diVhx86VIU5YjdqpIKYidloLY6Sm4YW6m2qFhW1deW4f41FWIT8t1pfRcxIuUIVIe4jNdqfSCvnsZ3irdA18iIUYlXirdFRIGhotESKJkpiRAAiRAAiRAApYkQJGwZLMwKBIgARIgARKIDAIUichoJ0ZJAiRAAiRAApYkQJGwZLMwKBIgARIgARKIDAIUichoJ0ZJAiRAAiRAApYkQJGwZLMwKBIgARIgARKIDAIUichoJ0ZJAiRAAiRAApYkQJGwZLMwKBIgARIgARKIDAIUichoJ0ZJAiRAAiRAApYkQJGwZLMwKBIgARIgARKIDAIUichoJ0ZJAiRAAiRAApYkQJGwZLMwKBIgARIgARKIDAIUichoJ0ZJAiRAAiRAApYkQJGwZLMwKBIgARIgARKIDAIUichoJ0ZJAiRAAiRAApYkQJGwZLMwKBIgARIgARKIDAIUichoJ0ZJAiRAAiRgMoHc/NV4+bV3IOactAlQJLTZcAsJkAAJkIBDCdTW1eHdDz7GoOEjHUrA/2pTJPxnxT1JgARIgAQcQkCORuw/cNAhNdZfTYqEfnY8kgRIgARIwKYEZsyex0safrYtRcJPUNyNBEiABEiABEjgcgIRKxJiuEncBKOVLq+q7zUyL6sMZcl4lPNefQZg4eKlOHfuvO8KedlDXP8T+Yj8RP7iOmCwNxQp45TLRsQbyraWcYq5EbF6Qe7XJq26yvYR7aZ3UtbVc9nMPq9VR2VMevuizMOzPsoy9fIL5jgZl9rcM1Z/ypH1EdfwPfuE3CbK0jMpj1eLV0+eavkYeb6J/iLOEVGOYCJGE45VHNcTatsxSga6M3EfmJqR1RaXqK9dJ4qEomVlZxedyAqTjEdtrvYF4m/M8iYitXzFCah3UstPrhPx6pUf5Ukt81PO9cSrPN5zOZhY9cSiPMZXXYO58cuznsrPZvZ5X3UUcVEklL3i8mUlw7XrNnTYQbmtwwY/PyiPV/YRuexnNh12k8eqzYM938R3llq+Yp1emVAy6FARHR/GTJhyKT6934E6ijX1EFuIhFHEZGcUncgKk1o823aUthm32CZMV88kRiLE8cKQZV3FF7csz/OLyd8y5PEyT3GcWBZfFGKbKFfPJPKQees5Xu0YmZ9WrHrZqpUVyDqtuoaqfQKJLVT7qrWF3rK08tLiqrecQI/TiivQfOT+yvqIP1TKSblNud7f5WCPVytHrf6iHPndoPd8E99VMm8pn+KPtRyd8GSjFpvaOiMZyPjEXO93q1qMVlpHkVC0hmxw0YmsMGnFI/+o6D1JhECodWopGHr/4GvFK0928aWhZzLypJbla8UaLFuZv965t7rK9tE7aqRVZ72xGnWckXFp5eWNq1H18JaPVlzejvG2TVkfkbfyP13lNm95aG0L9ni1fLXqH+z5Js8Jz+8sMRIhy1SLx9c6oxjIfIIVJl/xhns7RULRArLjica3wqQVj+ycYrueSear/PIR+QR7Ust8PfmJcuQ2PfEGW1+1MmU8nrGGoiy18rXWeStfCplegdSqs1YsZq03Mi6tvLxxNaOeWnHpLVtZH5G3YtePhgAACUpJREFU8j965TY9+Qd7vFqZWvUPtixxLoi8xXeX5yTL1HN5I9i4ZCzyO1Vefgnm0qTM04pzioSiVWTHE53ICpNWPMF0cm9/1GW+em8K0opXsJTbwnlSK9tUxuPZ1pKB2B6OyVv5cpvekR2tOoejnsoyjYxLKy/JLlztqhWXkkMgy8r6iLyV56xyWyB5yn2DPV7mo5xr1T/YsuToqsjHyCnYuGQsUnREfnJUwvPmWLlvJM8pEorW0+rsil1MXdSKJ5hO7u1Yb9v8qbhWvOJYb9t85R1sXGr5a8UTirLUytda5618b9u08lOu16qzcp9wLBsZl1ZewbILlotWXHrzVdZH/jEV90+JSblNT/7BHq9Wplb9gy1LK1+1GAJZF2xcsiwpD+KzUirkdrvMKRKKlgxVp1QUEdCiVjxyuEzPELe3E8TbNn8C14pXHOttm6+8g41LLX+teIJhq1ZOoOu81dXbNn/K0aqzP8eGch8j49LKK1h2wdZfKy69+SrrI/usvHdGuU1P/sEer1amVv1l7Hq+y0Q5WvmqxRDIOiMYyPs05OUMWVcxt9tkC5GQnUnORSfQMwV7vJ4yvR2jFo+om7Rc5XVRb/kot3k7QbxtU+ahtawWr9zX2za5j9ZcGZfMR87FNj2T2vEir2DY6onD8xhlXQPZ5rmv2mdZZ895uL/YZDx621JZV628vHFVHh+qZRmX51wve2V9xFC5zFcsK7fpqY/yeJmvnItteia140VewZ5vavnqic/zGCUDz23+fpbiIG8EFSNGIl690uRvueHYjyKhoB6qTqkoIqBFGY/aXJyAeq61eTtBvG3zJ3AZp8jHc/K2zXNfz8/KuGQ+cq5Wlufxap/l8WpzwdbzRlS1PEKxTllXz/y9bfPcV+2zWl3FOr1/zNTK0LNOxqW3LZVlauUVLDtlGXqWZVyec73sPesjb+YT+XluCzRe5fGe8YpteibPfJSfgznfZD4yLrXY5bZA4lbmE8hxyn3lL0pkG3u7P015XCQu20IkjALv2SmNyldvPjIe5VycdKKD6v1D5+0E8bbNnzrIONVOXG/bfOUdbFxq+ct4POfBfKmplRPoOm919bbNn3JkXdXax5/jQ7WPkXFp5RUsu2DrrhWX3nw96yP/2xX3S3huC7SMYI9XK0/W33Me7Pkm8xMxi0kZu+c2tbi01inz0drH13p574ryBnO1db7yiYTtFAlFKwXT8RTZGLYYini8nSDetvlTKW/xetvmK+9g41LL3zMe+dNKsV6vpKmVE+g6b3X1ts2fcjzr7M8xZuxjZFxaeQXLLlgOWnHpzVetPvKPlPgPWJanJ3+1vPXkozxGxiPyFpNR55tnvt7KVG7ztRwsA63RB+XIka8YImk7RULRWt46pWI30xZDEY+3E8TbNn8q7S1eb9t85R1sXGr5e8ajvM4shyLVjgv1Om919bbNn7g86+zPMWbsY2RcWnkFyy5YDlpx6c1XrT7inilRjhQKsaxnUstbTz7KYzzrb9T55pmvtzKV23wtB8tAKUoyRuVc3hjrK45I2U6RULSUbGjRiawwhSIeLVMW9ZUnj/gi0jN5i1duUw7z+VuGjEvkYdQk41G2tbymKe+yNqqsQPLxVle5TQwH65nU6qwnH6OPMTIurbwkO7E9HJNWXHpjUauP8tyW5enJXy1vPfkoj5HxiLzlZMT5Js4FkbcyX5m/Wplym695sAyk1MkYPOd6z2FfcYdrO0VCQV42tlqnVOxm2mKo4pH5eg7hyyFRvXcVy3w9+Sm/4PTAC/akVitTLVZ5nVls82Sjlkco1nmrq/wvx+j2CUU9AslTrS0COV65r1Ze3rgqjw/VslZcesvTqo/oG7IsMdczaeWtJy95jIxJ5C0nI843WV9xbnhOamV67qP1OVgG8l0foo7KSTkSE67vGGU8Ri1TJBQkg+l4imwMWwxVPHLo0/Pkk/8hiLmeSSte+QdQr4UHe1Kr1UUrVvkfTrgub3irq2wfvcOiWnVW42PmOiPj0urbsg/qHW0LloeRdRSxaPUTWU9Znp64tfLWk5c8RsYj8lZOwZ5v8p4Dz+8s5T8vev5gB8NAKQtqI7BafVTJJdKWKRKKFtPq7IpdTF0MVTzyD5Lo0PLEVn4BiWU9k1q8In/5ZeF5svtbRjAntVYZarGKfSWbcF3e0KqrHC0ScRvZPlp8zFyv1RZ6YpDtp+zbRvRBPbEojzGyjiJfrX4itsnzTZSpZ/KWt578xDFa9Zftpfd8U/veEuIgRwT0imMwDHwdK0dR9H4f6m2DUB5nC5GQnVQ51wNNebznsugcZk8yBqPLFsas/LKR5Yi53mFzwUaZj+eyKE/PfwYiX+WJ6Zmv+Kxnkvl4sjViuFVPPPIYX3XV+4Ur8pd1Vpt7cpDxmDGX8RgRg7e+Lfqg2B6OSdZRba6n3sp+4lkf+cdZlKVnUuatFq+ePGU+nnU14nyToxKyDOVcbUTAn/iVDPzZX7mPlH6t71K5PZhzWVmeFZYpEopWUHZAz2XPE0BxWMgWZQyhKFt8oYovHDnMJjp1sMP5Ml7lXOQvytErEQKu8qRW5i2X9TSAPFaNrZQsvf/564lHHqNVV9k+wfwhlHVWm6txkDGFei7jMSoGz74t+2Aw7IJlIOuoNtdTb2U/8YxN/PGU5Xhu8+ezMm+Zj3LuTx6e+8jj1epqxPkmvrvEOSLKEfkJudArESJ2JQPPuvj67GvEQSlP4eyTvuoRyPaIFYlAKsl9SYAESIAESIAEQkOAIhEarsyVBEiABEiABBxBgCLhiGZmJUmABEiABEggNAQoEqHhylxJgARIgARIwBEEKBKOaGZWkgRIgARIgARCQ4AiERquzJUESIAESIAEHEGAIuGIZmYlSYAESIAESCA0BCgSoeHKXEmABEiABEjAEQQoEo5oZlaSBEiABEiABEJDgCIRGq7MlQRIgARIgAQcQYAi4YhmZiVJgARIgARIIDQEKBKh4cpcSYAESIAESMARBCgSjmhmVpIESIAESIAEQkOAIhEarsyVBEiABEiABBxBgCLhiGZmJUmABEiABEggNAQoEqHhylxJgARIgARIwBEEKBKOaGZWkgRIgARIgARCQ4AiERquzJUESIAESIAEHEGAIuGIZmYlSYAESIAESCA0BCgSoeHKXEmABEiABEjAEQT+P5UT+J8WluD3AAAAAElFTkSuQmCC';

  const image = workbook.addImage({
    base64: base64Image,
    extension: 'png',
  });

  worksheet.addImage(image, 'A1:A3');

  // User and date cells

  worksheet.getCell('B1').value = 'Usuario:';
  worksheet.getCell('B1').font = { bold: true };
  worksheet.getCell('B2').value = 'Fecha de emisión:';
  worksheet.getCell('B2').font = { bold: true };
  worksheet.getCell('B3').value = 'Hora de emisión:';
  worksheet.getCell('B3').font = { bold: true };
  worksheet.getCell('C1').value = `${getUserInfo().first_name} ${getUserInfo().last_name}`;
  worksheet.getCell('C2').value = moment().format('DD/MM/YYYY');
  worksheet.getCell('C3').value = moment().format('HH:mm:ss');

  // Add autofilter to header
  worksheet.autoFilter = {
    from: 'A4',
    to: {
      row: 4,
      column: columns.length,
    },
  };

  for (let i = 65; i < 65 + columns.length; i++) {
    const cell = worksheet.getCell(`${String.fromCharCode(i)}4`);
    cell.fill = {
      type: 'pattern',
      pattern: 'solid',
      fgColor: { argb: 'FFEDEDED' },
    };
    cell.font = {
      bold: true,
    };
    cell.alignment = { vertical: 'middle', horizontal: 'center' };
    cell.border = {
      right: { style: 'thin', color: { argb: 'FFD9D9D9' } },
      bottom: { style: 'thin', color: { argb: 'FF8d8d8d' } },
    };
  }

  worksheet.addConditionalFormatting({
    ref: `A5:${String.fromCharCode(65 + columns.length - 1)}${rows.length + 4}`,
    rules: [
      {
        type: 'expression',
        formulae: ['MOD(ROW(),2)=0'],
        style: { fill: { type: 'pattern', pattern: 'solid', bgColor: { argb: 'FFFFFFFF' } } },
      },
    ],
  });

  worksheet.addConditionalFormatting({
    ref: `A5:${String.fromCharCode(65 + columns.length - 1)}${rows.length + 4}`,
    rules: [
      {
        type: 'expression',
        formulae: ['MOD(ROW(),2)<>0'],
        style: { fill: { type: 'pattern', pattern: 'solid', bgColor: { argb: 'FFEDEDED' } } },
      },
    ],
  });

  workbook.xlsx.writeBuffer().then((data) => {
    const blob = new Blob([data], {
      type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
    });
    fs.saveAs(blob, `${filename || 'download'}.xlsx`);
  });
};

export default generateExcelFile;
